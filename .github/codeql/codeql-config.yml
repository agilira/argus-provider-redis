name: "CodeQL Config for Argus Provider Redis"
disable-default-queries: false

queries:
  - name: security-and-quality
    uses: security-and-quality
  - name: security-extended
    uses: security-extended

# Custom query suites for Redis-specific security analysis
query-filters:
  - include:
      kind: problem
      tags:
        - security
        - external/cwe/cwe-089  # SQL Injection (applicable to Redis commands)
        - external/cwe/cwe-078  # OS Command Injection
        - external/cwe/cwe-079  # Cross-Site Scripting
        - external/cwe/cwe-918  # Server-Side Request Forgery
        - external/cwe/cwe-020  # Improper Input Validation
        - external/cwe/cwe-022  # Path Traversal
        - external/cwe/cwe-094  # Code Injection
        - external/cwe/cwe-295  # Certificate Validation
        - external/cwe/cwe-319  # Cleartext Transmission
        - external/cwe/cwe-326  # Inadequate Encryption Strength
        - external/cwe/cwe-327  # Use of Broken Cryptographic Algorithm
        - external/cwe/cwe-798  # Use of Hard-coded Credentials
        - external/cwe/cwe-807  # Reliance on Untrusted Inputs

# Redis-specific security patterns to focus on
paths:
  - "**/*.go"
  
# Exclude test files from certain security checks that might have intentionally vulnerable code
paths-ignore:
  - "**/test_*.go"
  - "**/*_test.go"
  - "**/testdata/**"
  
# Include additional queries for Redis security
packs:
  - codeql/go-queries:AlertSuppression.ql
  - codeql/go-queries:Security/CWE-020/IncompleteUrlSchemeCheck.ql
  - codeql/go-queries:Security/CWE-078/CommandInjection.ql
  - codeql/go-queries:Security/CWE-089/SqlInjection.ql
  - codeql/go-queries:Security/CWE-918/RequestForgery.ql